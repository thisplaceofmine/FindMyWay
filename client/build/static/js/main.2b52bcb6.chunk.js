(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{111:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),l=a(11),i=a(23),s=a(73),u=(a(89),a(24)),m=a(52),d=a(19),E=a(21),p=a(18),f=a(31),b=a(117),N=a(116),v=a(15),y=a.n(v),h=a(35),g=a(29),C=a.n(g),O=(C.a.create({baseURL:"http://localhost:5000/"}),C.a.create({baseURL:"https://geodata.gov.hk/gs/api/v1.0.0/"})),j=a(12),k=Object(j.a)(),R=function(e,t,a){return function(){var n=Object(h.a)(y.a.mark((function n(r){var c;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,C.a.post("/map",e,{headers:{authorization:"Bearer ".concat(t)}});case 3:c=n.sent,r({type:"UPDATE_USER",payload:c.data}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),S(n.t0,r,a);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},S=function(){var e=Object(h.a)(y.a.mark((function e(t,a,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(p.isUndefined)(t.response.data.Error)?(console.log(t.response),console.log(t.request)):(a({type:"ERR_USER_MISSING"}),Object(p.isUndefined)(n)||a({type:"ERR_REDIRECT",payload:{origin:n,message:"Login credential is invalid, Please re-login. "}}),k.push("/errorredirect"));case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),x=function(e){var t=Object(l.b)();Object(n.useEffect)((function(){t(function(){var e=Object(h.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("/auth/google/current_user");case 3:a=e.sent,console.log(a),t({type:"FETCH_USER",payload:a.data.data}),t({type:"HANDLE_TOKEN",payload:a.data.token}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())}),[]);var a=Object(l.c)((function(e){return{user:e.user}})),c=Object(n.useState)([{active:!1,direction:"/",name:"Home"},{active:!1,direction:"/users",name:"User"},{active:!1,direction:"/maps",name:"Map"}]),o=Object(d.a)(c,2),i=o[0],s=o[1],u=function(e){var t=Number(e.currentTarget.getAttribute("value")),a=Object(m.a)(i);a.forEach((function(e){return e.active=!1})),a[t].active=!0,s(a)};return r.a.createElement("div",{className:"container"},r.a.createElement(N.a,{bg:"light",expand:"lg"},r.a.createElement(N.a.Brand,null,"Find My Way"),r.a.createElement(N.a.Collapse,{id:"header"},r.a.createElement(N.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(b.a,{className:"mr-auto"},i.map((function(e,t){return r.a.createElement(b.a.Item,{className:"",key:t},r.a.createElement(E.a,{className:"nav-link",to:e.direction,value:t,onClick:u},e.name))})))),r.a.createElement("div",null,function(){if(Object(p.isNull)(a.user))return r.a.createElement("div",{className:"button"},"Loading");switch(a.user){case!1:return r.a.createElement("div",{className:"button"},r.a.createElement("a",{href:"/auth/google"},"Login with google"));default:return r.a.createElement(f.a,null,r.a.createElement(f.a.Toggle,null,"Welcome back"," ",Object(p.isUndefined)(a.user.name.givenName)?a.user.email:a.user.name.givenName),r.a.createElement(f.a.Menu,{className:"dropdown-menu-right"},r.a.createElement(f.a.Item,{onClick:function(){k.push("/users")}},"User"),r.a.createElement(f.a.Divider,null),r.a.createElement(f.a.Item,{href:"/auth/google/logout"},"Logout")))}}())))},T=function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"d-flex my-5"},r.a.createElement(E.b,{to:"/users",style:{textDecoration:"none",width:"50%"}},r.a.createElement("button",{className:"btn btn-warning btn-lg ",style:{fontSize:"50px",width:"100%"}},r.a.createElement("ion-icon",{name:"person-outline"}),r.a.createElement("br",null),"User")),r.a.createElement(E.b,{to:"/maps",style:{textDecoration:"none",width:"50%"}},r.a.createElement("button",{className:"btn btn-success btn-lg ",style:{fontSize:"50px",width:"100%"}},r.a.createElement("ion-icon",{name:"map-outline"}),r.a.createElement("br",null),"Map"))))},w=a(40),_=a(113),I=a(118),A=a(114),D=a(78),U=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),i=Object(d.a)(o,2),s=i[0],u=i[1],E=Object(n.useState)(!1),f=Object(d.a)(E,2),v=f[0],g=f[1],C=Object(n.useState)({}),j=Object(d.a)(C,2),k=j[0],S=j[1],x=Object(n.useState)({features:[]}),T=Object(d.a)(x,2),U=T[0],L=T[1],M=Object(w.d)({googleMapsApiKey:"AIzaSyCrtACkUxXqTfPq7yoKCwvv5o7RkRm7YvI"}).isLoaded,F=Object(l.c)((function(e){return{query:e.query,user:e.user,token:e.token}})),P=Object(l.b)();Object(n.useEffect)((function(){var e;""!==a&&P((e=a,function(){var t=Object(h.a)(y.a.mark((function t(a){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.get("/geoDataQuery?q=%7Bv%3A%221%2E0%2E0%22%2Cid%3A%22".concat(e,"%22%2Clang%3A%22ALL%22%7D"),{crossdomain:!0});case 3:n=t.sent,a({type:"FETCH_MAP_QUERY",payload:n.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[a]),Object(n.useEffect)((function(){S(F.query)}),[F.query]),Object(n.useEffect)((function(){F.user&&F.user.pinlist!==U.features&&L({features:F.user.pinlist})}),[F.user]);return M?function(){return r.a.createElement("div",{className:"container"},r.a.createElement("h3",{className:"mx-auto  text-center my-2 "},"Simple map"),r.a.createElement("div",null),r.a.createElement("div",null,(t=D,r.a.createElement(N.a,{bg:"dark",variant:"dark",id:"Point of interest"},r.a.createElement(b.a,{justify:!0,className:"mr-auto "},r.a.createElement("div",{className:"collapse navbar-collapse"},t.map((function(e,t){return r.a.createElement(_.a,{title:e.TypeNameEN,id:e.TypeNameEN,key:t},e.Features.map((function(e,t){return r.a.createElement(_.a.Item,{onClick:function(){c(e.id)},key:t},e.NameEN)})))}))),r.a.createElement("div",{className:"btn-group",role:"Toolbar button group"},r.a.createElement("button",{className:"btn btn-sm btn-outline-light",onClick:function(){S(U)}}," ","My favourite"),r.a.createElement("button",{type:"button",className:"btn btn-sm btn-outline-danger ",onClick:function(){c("")}},"Reset")))))),r.a.createElement(w.a,{id:"circle-example",mapContainerStyle:{height:"75vh",width:"100%"},zoom:11,center:{lat:22.396427,lng:114.109497},onClick:function(){return g(!1)}},!Object(p.isEmpty)(k.features)&&k.features.map((function(e,t){var a={lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0]};return r.a.createElement(w.c,{onClick:function(){u(e),v&&g(!1),g(!0)},key:t,position:a})})),v&&s&&r.a.createElement(w.b,{position:{lat:s.geometry.coordinates[1],lng:s.geometry.coordinates[0]},onCloseClick:function(){g(!1)}},r.a.createElement("div",null,r.a.createElement("h6",null,s.properties["Facility Name"]," ",function(e){if(F.user){if(0===U.features.filter((function(t){return t.properties["Facility Name"]===e.properties["Facility Name"]})).length){var t=[].concat(Object(m.a)(U.features),[e]);return r.a.createElement("ion-icon",{name:"heart-outline",size:"small",onClick:function(){return P(R(t,F.token,"/maps"))}})}var a=U.features.filter((function(t){return t.properties["Facility Name"]!==e.properties["Facility Name"]}));return r.a.createElement("ion-icon",{name:"heart",size:"small",onClick:function(){P(R(a,F.token,"/maps"))}})}return r.a.createElement(I.a,{placement:"bottom",delay:{show:150,hide:500},overlay:function(e){return r.a.createElement(A.a,Object.assign({id:"Favourite-Popup"},e),"You must login to save favourite.")}},r.a.createElement("ion-icon",{name:"heart-outline",size:"small"}))}(s)),r.a.createElement("ul",{style:{listStyleType:"none",paddingInlineStart:"5px"}},r.a.createElement("li",null,"Type: ",s.properties.Dataset),r.a.createElement("li",null,"Address: ",s.properties.Address),r.a.createElement("li",null,"Telephone: ",s.properties.Telephone),r.a.createElement("li",null,"Webside:"," ","N.A."===(e=s.properties.Website)?e:r.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},e)))))));var e,t}():null},L=a(30),M=a(59),F=a.n(M),P=a(115),H=a(79),Y=a(76),G=function(e){var t=Object(l.b)(),a=Object(n.useState)(),c=Object(d.a)(a,2),o=c[0],i=c[1],s=Object(l.c)((function(e){return{user:e.user,token:e.token}}));Object(n.useEffect)((function(){i(s.user)}),[s.user]);var u=function(){var e,a,n;t((e=o,a=s.token,n="/users",function(){var t=Object(h.a)(y.a.mark((function t(r){var c;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.post("/user",e,{headers:{authorization:"Bearer ".concat(a)}});case 3:c=t.sent,r({type:"FETCH_USER",payload:c.data.data}),r({type:"HANDLE_TOKEN",payload:c.data.token}),r({type:"ERR_REDIRECT",payload:{origin:n,message:"User Data has been updated!"}}),k.push("/errorredirect"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),S(t.t0,r,n);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()))};return Object(p.isEmpty)(o)?r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:" mx-auto my-4 "},r.a.createElement("h2",{className:"text-center"},"You must Login to continue."))):r.a.createElement("div",{className:"container-fluid my-auto"},r.a.createElement("h2",{className:"text-center my-1"}," PlaceHolder Header"),r.a.createElement(P.a,{autoComplete:""},r.a.createElement(P.a.Row,null,r.a.createElement(P.a.Group,{as:H.a,md:"6",controlId:"validationCustom01"},r.a.createElement(P.a.Label,null,"Given Name"),r.a.createElement(P.a.Control,{type:"text",placeholder:"Given Name",value:o.name.givenName||"",onChange:function(e){var t=e.target.value;i((function(e){return Object(L.a)({},e,{name:Object(L.a)({},e.name,{givenName:t})})}))}})),r.a.createElement(P.a.Group,{as:H.a,md:"6",controlId:"validationCustom02"},r.a.createElement(P.a.Label,null,"Family Name"),r.a.createElement(P.a.Control,{type:"text",placeholder:"Family Name",value:o.name.familyName||"",onChange:function(e){var t=e.target.value;i((function(e){return Object(L.a)({},e,{name:Object(L.a)({},e.name,{familyName:t})})}))}}))),r.a.createElement(P.a.Row,null,r.a.createElement(P.a.Group,{as:H.a,md:"4",controlId:"validationCustom03"},r.a.createElement(P.a.Label,null,"Email"),r.a.createElement(P.a.Control,{type:"text",placeholder:"Email",disabled:!0,value:o.email})),r.a.createElement(P.a.Group,{as:H.a,md:"4",controlId:"validationCustom03"},r.a.createElement(P.a.Label,null,"Profile Created"),r.a.createElement(P.a.Control,{type:"text",placeholder:"Profile Created",disabled:!0,value:F()(o.createdAt).format("DD MMMM YYYY hh:mm:ss a")})),r.a.createElement(P.a.Group,{as:H.a,md:"4",controlId:"validationCustom03"},r.a.createElement(P.a.Label,null,"Profile Last Edited "),r.a.createElement(P.a.Control,{type:"text",placeholder:"Profile Last Edited ",disabled:!0,value:F()(o.updatedAt).format("DD MMMM YYYY hh:mm:ss a")}))),r.a.createElement(P.a.Row,null,r.a.createElement(P.a.Group,{as:H.a,md:"11",controlId:"validationCustom04"}),r.a.createElement(P.a.Group,{as:H.a,md:"1",controlId:"validationCustom05"},r.a.createElement(Y.a,{varient:"primary",onClick:u},"Submit")))))},q=function(e){var t=Object(u.f)(),a=Object(l.b)(),c=Object(l.c)((function(e){return e.errorRedirect}));return Object(n.useEffect)((function(){return setTimeout((function(){t.push(c.origin)}),5e3),function(){a({type:"ERR_REDIRECT_RESET"})}}),[]),r.a.createElement("div",{className:"container my-3"},r.a.createElement("div",{className:"card text-center"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",null,c.message),r.a.createElement(E.a,{to:c.origin,className:"card-link"},"You will be redirected in 5 seconds, or click here if your browser does not redirect you."))))};var z=function(){return r.a.createElement("div",{className:"container"},r.a.createElement(u.b,{history:k},r.a.createElement(x,null),r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",exact:!0,component:T}),r.a.createElement(u.a,{path:"/maps",exact:!0,component:U}),r.a.createElement(u.a,{path:"/users",exact:!0,component:G}),r.a.createElement(u.a,{path:"/errorredirect",exact:!0,component:q}))))},B={origin:"/",message:""},K=Object(i.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_USER":case"UPDATE_USER":return t.payload||!1;case"ERR_USER_MISSING":return!1;default:return e}},query:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_MAP_QUERY":return Object(L.a)({},t.payload);default:return e}},token:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_TOKEN":return t.payload||"";default:return e}},errorRedirect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ERR_REDIRECT":return t.payload||B;case"ERR_REDIRECT_RESET":return B;default:return e}}}),W=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,Q=Object(i.e)(K,W(Object(i.a)(s.a)));o.a.render(r.a.createElement(l.a,{store:Q},r.a.createElement(z,null)),document.getElementById("root"))},78:function(e){e.exports=JSON.parse('[{"TypeNameCN":"\u793e\u6703\u798f\u5229","TypeNameEN":"Community and Social Welfare","Features":[{"NameCN":"\u56b4\u91cd\u6b98\u75be\u4eba\u58eb\u8b77\u7406\u9662","NameEN":"Care and Attention Home for Severely Disabled Persons","id":"c3150960-1e04-478e-9b11-41c2d488d48f"},{"NameCN":"\u76f2\u4eba\u8b77\u7406\u5b89\u8001\u9662","NameEN":"Care and Attention Home for the Aged Blind","id":"1ef0ed6d-80db-4988-8163-6397b1ff771b"},{"NameCN":"\u5e7c\u5152\u4e2d\u5fc3","NameEN":"Child Care Centre","id":"2cbe89f7-b959-4259-97c6-1610e7a2d9d1"}]},{"TypeNameCN":"\u6559\u80b2","TypeNameEN":"Education","Features":[{"NameCN":"\u8cc7\u52a9\u5c0f\u5b78","NameEN":"Aided Primary Schools","id":"41f53d43-7d82-4e44-9a9e-d4e9d1c4781c"},{"NameCN":"\u8cc7\u52a9\u4e2d\u5b78","NameEN":"Aided Secondary Schools","id":"b545518d-efe1-446d-8525-530b23047aba"},{"NameCN":"\u5b98\u7acb\u5c0f\u5b78","NameEN":"Government Primary Schools","id":"e55b1a7d-e52e-4f1a-903f-ab2edb93ebbb"},{"NameCN":"\u570b\u969b\u5b78\u6821\uff08\u5c0f\u5b78\uff09","NameEN":"International Schools (Primary)","id":"c64e5114-a331-4f5d-af74-06bc71694225"},{"NameCN":"\u570b\u969b\u5b78\u6821\uff08\u4e2d\u5b78\uff09","NameEN":"International Schools (Secondary)","id":"b819c93e-d17b-46b9-8b30-03302c7f77b9"}]},{"TypeNameCN":"\u74b0\u5883","TypeNameEN":"Environment","Features":[{"NameCN":"\u9999\u6e2f\u7a7a\u6c23\u8cea\u7d20\u76e3\u6e2c\u7db2\u7d61","NameEN":"Air Quality Monitoring Network of Hong Kong","id":"f94ad59d-a970-407a-abc6-8e5877f7efb0"},{"NameCN":"\u90ca\u91ce\u516c\u5712","NameEN":"Country Parks","id":"6bbc334b-cdb1-48ce-8a78-c58979327124"}]},{"TypeNameCN":"\u653f\u5e9c","TypeNameEN":"Government","Features":[{"NameCN":"\u51fa\u751f\u53ca\u6b7b\u4ea1\u767b\u8a18\u8655","NameEN":"Births and Deaths Registries","id":"f2a15891-25cd-454c-b032-619182c827d8"},{"NameCN":"\u6d3e\u905e\u5c40","NameEN":"Delivery Offices","id":"ebb49e65-1c67-41a1-b45a-2f14ebabeb85"},{"NameCN":"\u5a5a\u59fb\u767b\u8a18\u8655","NameEN":"Marriage Registries","id":"0841507d-ffb6-4f61-94e3-e30abec1c7b5"}]}]')},80:function(e,t,a){e.exports=a(111)}},[[80,1,2]]]);
//# sourceMappingURL=main.2b52bcb6.chunk.js.map